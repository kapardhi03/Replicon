# ============================================
# Replicon Copy Trading Platform
# Environment Configuration Template
# ============================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control!

# ============================================
# APPLICATION SETTINGS
# ============================================
APP_NAME="Replicon Copy Trading Platform"
VERSION="1.0.0"
ENVIRONMENT=development
DEBUG=true

# ============================================
# DATABASE CONFIGURATION
# ============================================
# PostgreSQL connection URL
# Format: postgresql+asyncpg://username:password@host:port/database
DATABASE_URL=postgresql+asyncpg://trading_user:trading_pass@localhost:5432/copy_trading

# Database pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10

# ============================================
# REDIS CONFIGURATION
# ============================================
# Redis connection URL
# Format: redis://host:port/db_number
REDIS_URL=redis://localhost:6379/0

# ============================================
# NATS JETSTREAM CONFIGURATION
# ============================================
# NATS server URL
NATS_URL=nats://localhost:4222

# NATS JetStream settings
NATS_STREAM_NAME=REPLICON_ORDERS
NATS_SUBJECT_PREFIX=replicon.orders
NATS_CONSUMER_NAME=order-worker

# ============================================
# SECURITY & AUTHENTICATION
# ============================================
# Secret key for JWT token generation
# IMPORTANT: Change this in production! Generate with: openssl rand -hex 32
SECRET_KEY=super-secret-key-change-this-in-production-123

# JWT settings
ACCESS_TOKEN_EXPIRE_MINUTES=30
ALGORITHM=HS256

# Encryption key for sensitive data (auto-generated if empty)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=

# ============================================
# IIFL API CONFIGURATION
# ============================================

# --- Blaze API (Master Account) ---
IIFL_BLAZE_API_URL=https://ttblaze.iifl.com

# --- Normal REST API (Follower Accounts) ---
IIFL_API_URL=https://api.iiflsecurities.com

# IIFL Vendor Credentials (get from IIFL)
IIFL_VENDOR_KEY=your_vendor_key_here
IIFL_VENDOR_CODE=your_vendor_code_here
IIFL_API_SECRET=your_api_secret_here

# Rate limiting
IIFL_RATE_LIMIT_PER_SECOND=10

# ============================================
# PERFORMANCE SETTINGS
# ============================================
# HTTP client connection pooling
HTTP_POOL_CONNECTIONS=100
HTTP_POOL_MAXSIZE=20
HTTP_KEEPALIVE_EXPIRY=60.0

# Order processing
MAX_CONCURRENT_ORDERS=50
ORDER_TIMEOUT_SECONDS=30

# ============================================
# RISK MANAGEMENT
# ============================================
# Enable/disable risk checking
ENFORCE_RISK_LIMITS=false

# Default limits (in INR)
DEFAULT_MAX_ORDER_VALUE=10000000.00  # ₹1 Crore
DEFAULT_MAX_DAILY_LOSS=5000000.00    # ₹50 Lakh

# ============================================
# LOGGING CONFIGURATION
# ============================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log file path (optional, logs to stdout if not set)
LOG_FILE=

# Use JSON format for logs (true/false)
JSON_LOGS=false

# ============================================
# CORS SETTINGS
# ============================================
# Allowed origins for CORS (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# ============================================
# MONITORING (OPTIONAL)
# ============================================
# Prometheus metrics endpoint enabled
ENABLE_METRICS=true

# Sentry DSN for error tracking (optional)
SENTRY_DSN=

# ============================================
# DEPLOYMENT SETTINGS
# ============================================
# Server host and port
HOST=0.0.0.0
PORT=8000

# Number of worker processes (for production)
WORKERS=4

# ============================================
# DEVELOPMENT SETTINGS
# ============================================
# Auto-reload on code changes (development only)
RELOAD=true

# ============================================
# NOTES
# ============================================
# 1. Always use strong, unique passwords in production
# 2. Never commit .env file to version control
# 3. Rotate secrets regularly
# 4. Use different credentials for development/staging/production
# 5. Enable SSL/TLS in production (use https://)
# 6. Set DEBUG=false in production
# 7. Configure proper CORS origins for production
# 8. Enable monitoring and alerting for production
# 9. Set up proper logging aggregation (ELK, Datadog, etc.)
# 10. Use environment-specific encryption keys

# ============================================
# QUICK START GUIDE
# ============================================
# 1. Copy this file: cp .env.example .env
# 2. Fill in your IIFL credentials
# 3. Generate SECRET_KEY: openssl rand -hex 32
# 4. Generate ENCRYPTION_KEY (optional, auto-generated if empty)
# 5. Adjust database/redis/nats URLs if needed
# 6. Start infrastructure: docker-compose up -d
# 7. Run migrations: alembic upgrade head
# 8. Start app: uvicorn main:app --reload
# 9. Start worker: python -m app.workers.order_worker
